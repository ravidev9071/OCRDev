<template>
	<div role="main" tabindex="-1" class="body mainBody isPageWidthFixed-true" aria-hidden="false">
		<div class="pageContainer">
			<div class="pageContent">
				<div class="siteforceSldsTwoCol84SidebarFeaturedLayout siteforceContentArea">
					<div class="slds-col--padded comm-content-header comm-layout-column">

						<div data-region-name="content">
							<div data-priority="" class="ui-widget">
								<div class="slds-text-heading_large">Manage Healthcare Settings</div>
								<div class="slds-m-bottom_large"></div>
								<div class="tileCards summary">

									<article class="slds-card slds-card_boundary">
										<!-- RT 15-10-24 changes -->
										<div class="slds-card__header slds-grid slds-wrap slds-grid_vertical-align-center">
											<header class="slds-media slds-media_center slds-has-flexi-truncate slds-size_1-of-1 slds-small-size_2-of-3">
												<div class="slds-media__figure">
													<span class="slds-icon_container slds-icon-standard-contact"
														title="contact">
														<svg class="slds-icon slds-icon_small" aria-hidden="true">
															<use
																xlink:href="/assets/icons/standard-sprite/svg/symbols.svg#contact">
															</use>
														</svg>
														<span class="slds-assistive-text">contact</span>
													</span>
												</div>
												<div class="slds-media__body">
													<h2 class="slds-card__header-title">
														<span>Associated Healthcare Settings</span>
													</h2>
												</div>
											</header>
											<div class="slds-no-flex slds-size_1-of-1 slds-small-size_1-of-3 slds-text-align_right slds-p-top_small">
												<button class="slds-button slds-button_brand" onclick={addHCSModalOpener}>
													Associate Another Healthcare Setting
												</button>
											</div>
										</div>										
										<div class="slds-card__body slds-card__body_inner">
											<ul class="slds-grid slds-wrap slds-grid_pull-padded">
												<template for:each={hcsList} for:item="record" for:index="index">
													<li key={record.Id}
														class="slds-p-horizontal_small slds-size_1-of-1 slds-large-size_1-of-3">
														<article
															class="slds-tile slds-media slds-card__tile slds-hint-parent">
															<div class="slds-media__figure">
																<span
																	class="slds-icon_container slds-icon-standard-contact"
																	title="Description of icon when needed">
																	<svg class="slds-icon slds-icon_small"
																		aria-hidden="true">
																		<use
																			xlink:href="/assets/icons/standard-sprite/svg/symbols.svg#contact">
																		</use>
																	</svg><span
																		class="slds-assistive-text">Contact</span>
																</span>
															</div>
															<div class="slds-media__body">
																<div class="slds-grid slds-grid_align-spread slds-has-flexi-truncate slds-cell-wrap"
																	data-label="Wrapped, line clamped">
																	<h3 class="slds-tile__title slds-truncate slds-line-clamp"
																		title="HCP 1">{record.Name}

																		<template if:true={record.hcscertified1}>
																			<span class="status certified">
																				{record.US_WSREMS__Status__c}
																			</span>
																		</template>
																		<template if:false={record.hcscertified1}>
																			<span class="pendingothercsss">
																				{record.US_WSREMS__Status__c}
																			</span>
																		</template>

																	</h3>
																	<div class="slds-shrink-none">
																		<button
																			class="slds-button slds-button_icon slds-button_icon-border-filled slds-button_icon-x-small"
																			aria-haspopup="true" title="More options">
																			<svg class="slds-button__icon slds-button__icon_hint"
																				aria-hidden="true">
																				<use
																					xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#down">
																				</use>
																			</svg>
																			<span class="slds-assistive-text">More
																				options</span>
																		</button>
																	</div>
																</div>
																<div class="slds-tile__detail">
																	<!--<div class="status certified">Certified</div>   -->
																	<p class='subtitle'>
																		{record.US_WSREMS__Address_Line_1__c}<br>{record.US_WSREMS__Address_Line_2__c}
																		{record.US_WSREMS__City__c},
																		{record.US_WSREMS__State__c}
																		{record.US_WSREMS__Zip__c}</p>
																	<div class="slds-form__row">
																		<div class="slds-form__item" role="listitem">
																			<div
																				class="slds-form-element slds-form-element_edit slds-form-element_readonly slds-form-element_horizontal slds-hint-parent">
																				<span
																					class="slds-form-element__label">DEA
																					Number (On file with distributor
																					account</span>
																				<div class="slds-form-element__control">
																					<div
																						class="slds-form-element__static">
																						{record.US_WSREMS__DEA__c}</div>
																					<button
																						class="slds-button slds-button_icon"
																						title="">
																						<svg class="slds-button__icon slds-button__icon_hint"
																							aria-hidden="true">
																							<use
																								xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#edit">
																							</use>
																						</svg>
																						<span
																							class="slds-assistive-text"></span>
																					</button>
																				</div>
																			</div>
																		</div><!-- end form item  -->
																		<div class="slds-form__item" role="listitem">
																			<div
																				class="slds-form-element slds-form-element_edit slds-form-element_readonly slds-form-element_horizontal slds-hint-parent">
																				<span
																					class="slds-form-element__label">Setting
																					Type</span>
																				<div class="slds-form-element__control">
																					<div
																						class="slds-form-element__static">
																						{record.US_WSREMS__Healthcare_Setting_Type__c}
																					</div>
																					<button
																						class="slds-button slds-button_icon"
																						title="">
																						<svg class="slds-button__icon slds-button__icon_hint"
																							aria-hidden="true">
																							<use
																								xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#edit">
																							</use>
																						</svg>
																						<span
																							class="slds-assistive-text"></span>
																					</button>
																				</div>
																			</div>
																		</div><!-- end form item  -->
																		<div class="slds-form__item" role="listitem">
																			<div
																				class="slds-form-element slds-form-element_edit slds-form-element_readonly slds-form-element_horizontal slds-hint-parent">
																				<span
																					class="slds-form-element__label">Re-enrollment
																					Date</span>
																				<div class="slds-form-element__control">
																					<div
																						class="slds-form-element__static">
																						{record.formattedCreatedDate}
																					</div>
																					<button
																						class="slds-button slds-button_icon"
																						title="">
																						<svg class="slds-button__icon slds-button__icon_hint"
																							aria-hidden="true">
																							<use
																								xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#edit">
																							</use>
																						</svg>
																						<span
																							class="slds-assistive-text"></span>
																					</button>
																				</div>
																			</div>
																		</div><!-- end form item  -->
																	</div>
																</div>
																<footer class="slds-card__footer">
																	<a class="slds-card__footer-action slds-button slds-button_outline-brand"
																		data-id={record.Id} data-index={index}
																		onclick={disassociateHandler}>Disassociate
																		<span
																			class="slds-assistive-text">Disassociate</span>
																	</a>
																</footer>
															</div>
														</article>
													</li>
												</template>
											</ul>
										</div>

										<section lwc:if={disassociateModalOpen} role="dialog" tabindex="-1"
											aria-modal="true" aria-labelledby="modal-heading-01"
											class="slds-modal slds-fade-in-open">
											<div class="slds-modal__container">
												<lightning-modal-header
													class="slds-border_top slds-border_left slds-border_right"
													style="border-radius:5px"
													label="Are you sure ?"></lightning-modal-header>
												<lightning-modal-body><br><br>{msg}<br><br></lightning-modal-body>
												<lightning-modal-footer>
													<!-- <lightning-button style="background-color:red !important" class="slds-float_left"  label="Cancel" onclick={handleCancel}></lightning-button> -->
													<button title="Cancel" type="button"
														class="brand-button slds-button slds-button_text-destructive cancelbtn"
														onclick={handleCancel}>Cancel</button>

													<lightning-button label="Submit"
														onclick={handleSubmit}></lightning-button>
												</lightning-modal-footer>
											</div>
										</section>
										<section lwc:if={openAddHCSModal} role="dialog" tabindex="-1" aria-modal="true"
											aria-labelledby="modal-heading-01" class="slds-modal slds-fade-in-open">
											<div class="slds-modal__container"
												style="width:80% !important;max-width:80% !important;">
												<div class="slds-m-bottom_small">
													<lightning-icon class="slds-float_right" variant='warning'
														icon-name='utility:close' alternative-text='close'
														style="background-color:white;cursor:pointer;" size='medium'
														title='close' onclick={closeAddHCSModal}></lightning-icon>
												</div>
												<lightning-modal-body class="slds-border_top"
													style="border-radius:5px;height:550px !important;overflow-x: hidden;overflow-y: scroll;">
													<div class="slds-p-around_medium "
														style="background-color:#f7f7f7;">
														<div class="dividerSolid"></div>
														<div class="slds-text-heading_medium">Healthcare Setting
															Information Search</div>
														<p class="txtInstructions">To associate a Healthcare Setting,
															please search to
															see
															if your healthcare setting already exists in the AVEED REMS.
															Please provide the Enrollment ID, Healthcare Setting Name,
															State or Zip Code
															and
															click "Search". </p>
														<div class="slds-grid slds-wrap slds-gutters">
															<div class="slds-col slds-medium-size_8-of-12">
																<div class="slds-form-element">
																	<label class="slds-form-element__label"
																		for="text-input-id-0">
																		<abbr class="slds-required" title="required">*
																		</abbr>Enrollment
																		ID,
																		Healthcare Setting Name, State, or Zip
																		Code</label>
																	<div class="slds-form-element__control"><input
																			id="text-input-id-0" placeholder=""
																			type="text" class="slds-input"
																			value={searchTerm}
																			oninput={handleSearchTerm}></div>
																</div>
															</div> <!-- end col  -->
															<div
																class="slds-col slds-wrap slds-large-size_2-of-12 search-btn  slds-m-top_xx-small">
																<button
																	class="slds-button slds-m-top_large slds-button_outline-brand"
																	onclick={handleSearch}>Search</button>
															</div>
														</div> <!-- end row  -->
														<template lwc:if={showSearchResults}>
															<div id="HCSResults" class="tblContainer">
																<h2 id="element-with-table-label4"
																	class="slds-text-heading_medium slds-m-bottom_xx-small">
																	Certified
																	Healthcare
																	Settings</h2>
																<p class="txtInstructions">Select the Healthcare Setting
																	you would like
																	to
																	associate to.
																	<br><br>If the Healthcare Setting is not found in
																	the table below,
																	please
																	check the box for "I cannot find my Healthcare
																	Setting" below to
																	enroll
																	new.
																</p>
																<!-- RT 18-10-24 changes -->
																<div class="slds-scrollable" style="height: 40vh;">
																	<table
																	class="slds-table slds-table_cell-buffer slds-table_bordered slds-table_striped"
																	aria-labelledby="element-with-table-label other-element-with-table-label">
																	<thead>
																		<tr class="slds-line-height_reset">
																			<th class="slds-text-align_right"
																				scope="col" style="width:3.25rem">
																				<div class="slds-truncate slds-assistive-text"
																					id="column-group-header"
																					title="Choose a row to select">
																					Choose a row to select</div>
																			</th>
																			<th class="slds-is-sortable" scope="col">
																				<div class="slds-truncate" title="Name">
																					Name</div>
																			</th>
																			<th class="slds-is-sortable" scope="col">
																				<div class="slds-truncate"
																					title="Address">Address</div>
																			</th>
																			<th class="slds-is-sortable" scope="col">
																				<div class="slds-truncate" title="City">
																					City</div>
																			</th>
																			<th class="slds-is-sortable" scope="col">
																				<div class="slds-truncate"
																					title="State">State</div>
																			</th>
																			<th class="slds-is-sortable" scope="col">
																				<div class="slds-truncate"
																					title="ZIP Code">ZIP Code
																				</div>
																			</th>
																			<th class="slds-is-sortable" scope="col">
																				<div class="slds-truncate"
																					title="Phone">Phone</div>
																			</th>
																			<th class="slds-is-sortable" scope="col">
																				<div class="slds-truncate" title="NPI">
																					Enrollment ID
																				</div>
																			</th>
																		</tr>
																	</thead>
																	<tbody>
																		<template lwc:if={hasSearchResults}>
																			<template for:each={searchResults}
																				for:item="result">
																				<tr class="slds-hint-parent"
																					key={result.Id}>
																					<td class="slds-text-align_right"
																						role="gridcell">
																						<span class="slds-radio"
																							onclick={handleSelectedRow}
																							data-id={result.Id}>
																							<input type="radio"
																								name="searchResultsRadio"
																								tabindex="-1"
																								value={result.Id}
																								checked={result.checked} />
																							<label
																								class="slds-radio__label"
																								for="rbHCS1"
																								id="radio-button-label-01"><span
																									class="slds-radio_faux"></span></label>
																						</span>
																					</td>
																					<td data-label="Account Name">
																						<div class="slds-cell-wrap">
																							{result.Name}</div>
																					</td>

																					<td data-label="Address">
																						<div class="slds-truncate"
																							title={result.US_WSREMS__Address_Line_1__c}>
																							{result.US_WSREMS__Address_Line_1__c}
																						</div>
																					</td>
																					<td data-label="City">
																						<div class="slds-truncate"
																							title={result.US_WSREMS__City__c}>
																							{result.US_WSREMS__City__c}
																						</div>
																					</td>
																					<td data-label="State">
																						<div class="slds-truncate"
																							title={result.US_WSREMS__State__c}>
																							{result.US_WSREMS__State__c}
																						</div>
																					</td>
																					<td data-label="ZIP Code">
																						<div class="slds-truncate"
																							title={result.US_WSREMS__Zip__c}>
																							{result.US_WSREMS__Zip__c}
																						</div>
																					</td>
																					<td data-label="Phone">
																						<div class="slds-truncate"
																							title={result.Phone}>
																							{result.Phone}
																						</div>
																					</td>
																					<td data-label="Enrollment ID">
																						<div class="slds-truncate"
																							title={result.US_WSREMS__REMS_ID__c}>
																							{result.US_WSREMS__REMS_ID__c}
																						</div>
																					</td>
																				</tr>
																			</template>
																		</template>
																	</tbody>
																	</table>
																</div>
																<template if:false={hasSearchResults}>
																	<p class="txtInstructions slds-p-around_small">No
																		results found.</p>
																</template>

																<div class="slds-m-vertical_x-large"></div>
																<div class="slds-form-element">
																	<div class="slds-form-element__control">
																		<div class="slds-checkbox">
																			<input type="checkbox" name="options"
																				id="cbNewPharmHCS"
																				checked={createSettingOption}
																				onchange={handleCheckSetting}>
																			<label class="slds-checkbox__label"
																				for="cbNewPharmHCS">
																				<span class="slds-checkbox_faux"></span>
																				<span class="slds-form-element__label">I
																					cannot find my
																					Healthcare Setting</span>
																			</label>
																		</div>
																	</div>
																</div>

																<template lwc:if={createSettingOption}>
																	<div id="HCSEntry">
																		<div class="dividerSolid"></div>
																		<h2 id="element-with-table-label"
																			class="slds-text-heading_medium slds-m-bottom_xx-small">
																			Healthcare Setting Information</h2>
																		<p class="txtInstructions">Please provide
																			Healthcare Setting
																			information.</p>

																		<div class="slds-grid slds-wrap">
																			<div class="slds-col slds-size_1-of-1">
																				<lightning-input
																					data-id="affiliationData"
																					label=" Healthcare Setting Name"
																					name="name"
																					onchange={handleInputChange}
																					required></lightning-input>
																			</div>
																			<div class="slds-col slds-size_1-of-2">
																				<lightning-input
																					data-id="affiliationData"
																					label=" Ship to Address 1"
																					name="addressLine1"
																					onchange={handleInputChange}
																					required></lightning-input>
																				<lightning-input
																					data-id="affiliationData"
																					label=" City" name="city"
																					onchange={handleInputChange}
																					required></lightning-input>
																			</div>
																			<!--RT 18-10-24 changes -->
																			<div
																				class="slds-col slds-size_1-of-2 slds-p-left_large">
																				<lightning-input
																					data-id="affiliationData"
																					label=" Ship to Address 2"
																					name="addressLine2"
																					onchange={handleInputChange}></lightning-input>
																				<lightning-combobox
																					data-id="affiliationData"
																					class="search slds-form-element"
																					label=" State" required
																					options={stateOptions}
																					onchange={handleInputChange}
																					name="state"></lightning-combobox>
																				<lightning-input
																					data-id="affiliationData"
																					label=" ZIP Code"
																					name="zipCode"
																					onchange={handleInputChange}
																					required>
																				</lightning-input>
																			</div>
																		</div>

																	</div>
																</template>
															</div>
														</template>
														<div class="slds-p-vertical_x-large"></div>

														<div class="slds-show">
															<div class="containerEmphasis slds-p-around_small"
																style="background-color:rgb(223 112 0 / 5%);">
																<p class="txtInstructions">Click "Affiliate to Another
																	Healthcare
																	Setting" to add additional affiliated healthcare
																	settings, if
																	necessary.</p>
																<!-- RT 15-10-24 changes -->
																<div class="slds-grid slds-wrap slds-grid_align-spread slds-grid_vertical-align-end">
																	<div class="slds-size_1-of-1 slds-small-size_1-of-2 slds-p-top_small">
																		<button onclick={handleAffiliate} id="BtnAnotherHCS"
																			disabled={isAffiliateDisabled}
																			class="slds-button slds-m-top_large slds-button_brand slds-button_outline-brand"
																			aria-disabled="false" type="button"
																			part="button" kx-scope="button-brand"
																			kx-type="ripple">Affiliate to Another
																			Healthcare Setting</button>
																	</div>
																	<div class="slds-size_1-of-1 slds-small-size_1-of-2 slds-p-top_small">
																		<button title="Cancel" type="button"
																			class="brand-button slds-button slds-button_text-destructive"
																			onclick={closeAddHCSModal}>Cancel</button>
																	</div>
																</div>
																
															</div>
															<div class="slds-p-bottom_large"></div>
														</div>
													</div>
												</lightning-modal-body>
												<lightning-modal-footer>
													&nbsp;
												</lightning-modal-footer>
											</div>
										</section>
										<lightning-spinner lwc:if={isLoading} alternative-text="Loading"
											size="medium"></lightning-spinner>

										<footer class="slds-card__footer slds-hide">
											<a class="slds-card__footer-action" href="#">
												View All
												<span class="slds-assistive-text">Contacts</span>
											</a>
										</footer>
									</article>
								</div>
							</div> <!-- end ui-widget   -->
						</div>

					</div> <!-- end SF   -->
				</div> <!-- end pageContent   -->
			</div> <!-- end pageContainer   -->

		</div> <!-- end main   -->
		<div class="footer siteFooter" aria-hidden="false">
			<div data-region-name="themeFooter">
				<div data-priority="" class="ui-widget">
					<div class="" data-aura-class="forceCommunityRichText forceCommunityRichTextInline">
						<div dir="ltr" class="uiOutputRichText" data-aura-class="uiOutputRichText">

							<!-- COMMON FOOTER   -->
							<!-- script src="files/contentFooter.js"></script> -->

						</div>
					</div>

				</div>
			</div>
		</div>
	</div>

</template>